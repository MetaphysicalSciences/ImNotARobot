<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<style>
html,body{margin:0;padding:0;overflow:hidden;background:#000;height:100%;touch-action:none;-webkit-user-select:none;}
canvas{display:block;background:radial-gradient(circle at center,#111,#000);}
#joystick{position:absolute;bottom:60px;left:60px;width:120px;height:120px;border-radius:50%;background:rgba(255,255,255,0.08);}
#stick{position:absolute;top:45px;left:45px;width:30px;height:30px;border-radius:50%;background:rgba(255,255,255,0.3);}
#score{position:absolute;top:20px;left:50%;transform:translateX(-50%);font-family:sans-serif;color:#0f0;font-size:28px;text-shadow:0 0 10px #0f0;}
#lose{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);justify-content:center;align-items:center;flex-direction:column;font-family:sans-serif;color:#fff;}
#lose button{margin-top:30px;font-size:22px;padding:12px 25px;background:#0f0;border:none;border-radius:8px;color:#000;}
#menu{position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at center,#000,#040);display:flex;justify-content:center;align-items:center;flex-direction:column;font-family:sans-serif;color:#0f0;}
#menu h1{font-size:60px;margin-bottom:40px;text-shadow:0 0 20px #0f0;}
#menu button{margin:10px;font-size:24px;padding:12px 30px;background:#0f0;border:none;border-radius:8px;color:#000;}
#settings{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);justify-content:center;align-items:center;flex-direction:column;color:#0f0;font-family:sans-serif;}
#settings select{margin:10px;padding:10px;background:#000;color:#0f0;border:1px solid #0f0;font-size:18px;}
#settings button{margin-top:30px;font-size:22px;padding:12px 25px;background:#0f0;border:none;border-radius:8px;color:#000;}
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="joystick"><div id="stick"></div></div>
<div id="score">0</div>
<div id="lose"><div id="msg">You Lost!</div><button id="retry">Retry</button></div>
<div id="menu">
<h1>Snake 2025</h1>
<button id="startBtn">Start</button>
<button id="settingsBtn">Settings</button>
</div>
<div id="settings">
<div>Player Shape:</div>
<select id="shapeSel">
<option value="round">Round</option>
<option value="diamond">Diamond</option>
<option value="blocky">Blocky</option>
</select>
<div>Player Colour:</div>
<select id="colorSel">
<option value="#0f0">Green</option>
<option value="#0ff">Cyan</option>
<option value="#ff0">Yellow</option>
<option value="#f0f">Magenta</option>
<option value="#f00">Red</option>
</select>
<button id="backBtn">Back</button>
</div>
<script>
const c=document.getElementById('game'),x=c.getContext('2d');
let w=c.width=innerWidth,h=c.height=innerHeight;
addEventListener('resize',()=>{w=c.width=innerWidth;h=c.height=innerHeight;});
let grid=20,segments=[],length=10,angle=0,speed=140,score=0,fruit=[],over=false,playing=false;
let shape="round",snakeColor="#0f0";
function resetSnake(){segments=[];for(let i=0;i<length;i++)segments.push({x:w/2-i*grid,y:h/2});angle=0;}
function spawnFruit(){fruit=[];for(let i=0;i<3;i++){fruit.push({x:Math.random()*w,y:Math.random()*h,t:i});}}
function resetGame(){length=10;score=0;over=false;resetSnake();spawnFruit();}
resetSnake();spawnFruit();
function drawSnake(){
x.shadowBlur=10;x.shadowColor=snakeColor;x.fillStyle=snakeColor;
for(let i=0;i<segments.length;i++){
let s=segments[i];
if(shape==="round"){x.beginPath();x.arc(s.x,s.y,grid/2,0,Math.PI*2);x.fill();}
else if(shape==="blocky"){x.fillRect(s.x-grid/2,s.y-grid/2,grid,grid);}
else{ x.save();x.translate(s.x,s.y);x.rotate(Math.PI/4);x.fillRect(-grid/2,-grid/2,grid,grid);x.restore();}
}}
function drawFruit(t,f){
let col=t==0?"#f00":t==1?"#0ff":"#ff0";
x.shadowBlur=20;x.shadowColor=col;x.fillStyle=col;
x.save();x.translate(f.x,f.y);
if(t==0){x.beginPath();x.moveTo(0,-10);for(let i=0;i<5;i++){x.lineTo(10*Math.cos(i*2*Math.PI/5-1.57),10*Math.sin(i*2*Math.PI/5-1.57));}x.closePath();x.fill();}
else if(t==1){x.beginPath();x.arc(0,0,8+Math.sin(Date.now()/200)*2,0,Math.PI*2);x.fill();}
else{x.rotate(Date.now()/500);x.fillRect(-8,-8,16,16);}
x.restore();
}
function moveSnake(dt){
let head=segments[0];
head.x+=Math.cos(angle)*speed*dt;
head.y+=Math.sin(angle)*speed*dt;
if(head.x<0)head.x=w; if(head.x>w)head.x=0; if(head.y<0)head.y=h; if(head.y>h)head.y=0;
for(let i=segments.length-1;i>0;i--){
let dx=segments[i-1].x-segments[i].x;
let dy=segments[i-1].y-segments[i].y;
let dist=Math.hypot(dx,dy);
if(dist>grid-1){segments[i].x+=dx/dist*(dist-(grid-1));segments[i].y+=dy/dist*(dist-(grid-1));}
}
for(let i=4;i<segments.length;i++){
if(Math.hypot(segments[0].x-segments[i].x,segments[0].y-segments[i].y)<grid/1.5){over=true;document.getElementById('lose').style.display='flex';playing=false;}
}
for(let f of fruit){
if(Math.hypot(head.x-f.x,head.y-f.y)<grid){
let add=f.t==0?2:f.t==1?4:6;score+=add*10;for(let i=0;i<add;i++)segments.push({...segments[segments.length-1]});spawnFruit();
}
}}
function draw(){
x.clearRect(0,0,w,h);
for(let f of fruit)drawFruit(f.t,f);
drawSnake();
document.getElementById('score').textContent=score;
}
let last=0;
function loop(t){let dt=(t-last)/1000;last=t;if(playing&&!over){moveSnake(dt);draw();requestAnimationFrame(loop);}}
const j=document.getElementById('joystick'),s=document.getElementById('stick');
let act=false,sx=0,sy=0;
j.addEventListener('touchstart',e=>{e.preventDefault();act=true;sx=e.touches[0].clientX;sy=e.touches[0].clientY;});
j.addEventListener('touchmove',e=>{if(!act)return;let tx=e.touches[0].clientX-sx,ty=e.touches[0].clientY-sy;let a=Math.atan2(ty,tx);s.style.transform=`translate(${Math.min(40,Math.hypot(tx,ty))*Math.cos(a)}px,${Math.min(40,Math.hypot(tx,ty))*Math.sin(a)}px)`;angle=a;});
j.addEventListener('touchend',()=>{act=false;s.style.transform='translate(0,0)';});
document.addEventListener('gesturestart',e=>e.preventDefault());
document.addEventListener('dblclick',e=>e.preventDefault());
document.addEventListener('touchmove',e=>{if(e.scale!==1)e.preventDefault();},{passive:false});
document.getElementById('retry').onclick=()=>{resetGame();document.getElementById('lose').style.display='none';playing=true;requestAnimationFrame(loop);}
document.getElementById('startBtn').onclick=()=>{document.getElementById('menu').style.display='none';playing=true;resetGame();requestAnimationFrame(loop);}
document.getElementById('settingsBtn').onclick=()=>{document.getElementById('menu').style.display='none';document.getElementById('settings').style.display='flex';}
document.getElementById('backBtn').onclick=()=>{shape=document.getElementById('shapeSel').value;snakeColor=document.getElementById('colorSel').value;document.getElementById('settings').style.display='none';document.getElementById('menu').style.display='flex';}
</script>
</body>
</html>
