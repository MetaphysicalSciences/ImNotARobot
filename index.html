<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>XP Shooter</title>
<style>
body {
  margin: 0;
  font-family: 'Tahoma','Verdana','Segoe UI',sans-serif;
  background: #008080;
  user-select: none;
  overflow: hidden;
}
.window {
  background: #C0C0C0;
  border: 2px solid #000080;
  width: 400px;
  padding: 10px;
  margin: 20px auto;
  box-shadow: 4px 4px 8px #00000088;
}
.window-header {
  background: #000080;
  color: white;
  padding: 5px;
  font-weight: bold;
  cursor: default;
}
.button {
  background: #C0C0C0;
  border: 2px solid #fff;
  padding: 5px 10px;
  margin: 5px;
  cursor: pointer;
  display: inline-block;
}
.button:hover {
  background: #A0A0A0;
}
.setting-label {
  display: block;
  margin: 5px 0 0 0;
}
canvas {
  display: block;
  margin: 0 auto;
  background: #004040;
}
</style>
</head>
<body>

<div id="mainMenu" class="window">
  <div class="window-header">XP Shooter - Main Menu</div>
  <div style="padding:10px;">
    <div class="button" onclick="startGame()">Start Game</div>
    <div class="button" onclick="showSettings()">Settings</div>
    <div class="button" onclick="exitGame()">Exit</div>
  </div>
</div>

<div id="settingsMenu" class="window" style="display:none;">
  <div class="window-header">Settings</div>
  <div style="padding:10px;">
    <label class="setting-label"><input type="checkbox" id="mobileMode"> Mobile Mode</label>
    <label class="setting-label"><input type="checkbox" id="particles"> Enable Particles</label>
    <label class="setting-label"><input type="checkbox" id="enemyShapes"> Enemy Shapes</label>
    <label class="setting-label"><input type="checkbox" id="playerShape"> Player Shape</label>
    <label class="setting-label"><input type="checkbox" id="fullscreen"> Fullscreen</label>
    <label class="setting-label"><input type="checkbox" id="sounds"> Sounds</label>
    <label class="setting-label"><input type="checkbox" id="difficulty"> Hard Mode</label>
    <label class="setting-label"><input type="checkbox" id="trail"> Bullet Trails</label>
    <label class="setting-label"><input type="checkbox" id="shake"> Screen Shake</label>
    <label class="setting-label"><input type="checkbox" id="colorful"> Colorful Particles</label>
    <label class="setting-label"><input type="checkbox" id="speed"> Increase Speed</label>
    <label class="setting-label"><input type="checkbox" id="gravity"> Gravity</label>
    <div class="button" onclick="backToMenu()">Back</div>
  </div>
</div>

<canvas id="gameCanvas" width="800" height="600" style="display:none;"></canvas>

<script>
let canvas = document.getElementById('gameCanvas');
let ctx = canvas.getContext('2d');
let gameRunning = false;
let player = {x:400, y:500, size:20, color:'#00FF00', bullets:[]};
let enemies = [];
let particles = [];
let keys = {};
let mobileMode = false;

function startGame() {
  document.getElementById('mainMenu').style.display='none';
  document.getElementById('settingsMenu').style.display='none';
  canvas.style.display='block';
  mobileMode = document.getElementById('mobileMode').checked;
  initGame();
  gameRunning = true;
  requestAnimationFrame(gameLoop);
}

function showSettings() {
  document.getElementById('mainMenu').style.display='none';
  document.getElementById('settingsMenu').style.display='block';
}

function backToMenu() {
  document.getElementById('settingsMenu').style.display='none';
  document.getElementById('mainMenu').style.display='block';
}

function exitGame() {
  alert('Thank you for playing!');
}

document.addEventListener('keydown', e => keys[e.key.toLowerCase()]=true);
document.addEventListener('keyup', e => keys[e.key.toLowerCase()]=false);
canvas.addEventListener('touchstart', e => keys[' '] = true);
canvas.addEventListener('touchend', e => keys[' '] = false);

function initGame() {
  player.x = canvas.width/2;
  player.y = canvas.height-50;
  player.bullets = [];
  enemies = [];
  particles = [];
  for(let i=0;i<10;i++){
    enemies.push({x:Math.random()*canvas.width, y:Math.random()*200, size:20, color:'#FF0000', dir:1});
  }
}

function spawnParticles(x,y,color){
  for(let i=0;i<10;i++){
    particles.push({x:x, y:y, vx:(Math.random()-0.5)*4, vy:(Math.random()-0.5)*4, life:50, color:color});
  }
}

function drawPlayer(){
  ctx.fillStyle = player.color;
  if(document.getElementById('playerShape').checked){
    ctx.beginPath();
    ctx.moveTo(player.x,player.y-player.size);
    ctx.lineTo(player.x-player.size,player.y+player.size);
    ctx.lineTo(player.x+player.size,player.y+player.size);
    ctx.closePath();
    ctx.fill();
  } else {
    ctx.beginPath();
    ctx.arc(player.x,player.y,player.size,0,Math.PI*2);
    ctx.fill();
  }
}

function drawEnemies(){
  enemies.forEach(e=>{
    ctx.fillStyle = e.color;
    if(document.getElementById('enemyShapes').checked){
      ctx.fillRect(e.x-e.size/2, e.y-e.size/2, e.size, e.size);
    } else {
      ctx.beginPath();
      ctx.arc(e.x, e.y, e.size,0,Math.PI*2);
      ctx.fill();
    }
  });
}

function drawBullets(){
  ctx.fillStyle='#FFFF00';
  player.bullets.forEach(b=>{
    ctx.beginPath();
    ctx.arc(b.x,b.y,5,0,Math.PI*2);
    ctx.fill();
  });
}

function updateGame(){
  if(keys['arrowleft'] || keys['a']) player.x -= mobileMode?6:4;
  if(keys['arrowright'] || keys['d']) player.x += mobileMode?6:4;
  if(keys[' '] && player.bullets.length<5){
    player.bullets.push({x:player.x, y:player.y-20});
  }
  player.bullets.forEach((b,i)=>{
    b.y-=8;
    enemies.forEach((e,j)=>{
      let dx=b.x-e.x;
      let dy=b.y-e.y;
      if(Math.sqrt(dx*dx+dy*dy)<e.size+5){
        if(document.getElementById('particles').checked) spawnParticles(e.x,e.y,e.color);
        enemies.splice(j,1);
        player.bullets.splice(i,1);
      }
    });
    if(b.y<0) player.bullets.splice(i,1);
  });

  enemies.forEach(e=>{
    e.y += 1;
    if(e.y>canvas.height) e.y=0;
  });

  particles.forEach((p,i)=>{
    p.x += p.vx;
    p.y += p.vy;
    p.life--;
    if(p.life<=0) particles.splice(i,1);
  });

  if(enemies.some(e=>Math.abs(e.x-player.x)<player.size+e.size && Math.abs(e.y-player.y)<player.size+e.size)){
    gameOver();
  }
}

function drawParticles(){
  particles.forEach(p=>{
    ctx.fillStyle = document.getElementById('colorful').checked?`hsl(${Math.random()*360},100%,50%)`:p.color;
    ctx.fillRect(p.x,p.y,2,2);
  });
}

function gameLoop(){
  if(!gameRunning) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawPlayer();
  drawEnemies();
  drawBullets();
  drawParticles();
  updateGame();
  requestAnimationFrame(gameLoop);
}

function gameOver(){
  gameRunning=false;
  canvas.style.display='none';
  let overDiv = document.createElement('div');
  overDiv.className='window';
  overDiv.innerHTML=`<div class="window-header">Game Over</div>
  <div style="padding:10px;">
  <div class="button" onclick="retryGame(this)">Retry</div>
  <div class="button" onclick="endGame(this)">Main Menu</div>
  </div>`;
  document.body.appendChild(overDiv);
}

function retryGame(el){
  el.closest('.window').remove();
  startGame();
}

function endGame(el){
  el.closest('.window').remove();
  document.getElementById('mainMenu').style.display='block';
}

</script>

</body>
</html>
