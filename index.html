<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Im not a bot ü§ñ</title>
<style>
:root{
  --bg:#f4f6f8;
  --card:#ffffff;
  --accent:#1a73e8;
  --ok:#16a34a;
  --danger:#ef4444;
  --muted:#6b7280;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  background:linear-gradient(180deg,#eef2ff 0%,var(--bg) 60%);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:28px;
  color:#111827;
}
.app{
  width:980px;
  max-width:96%;
  background:transparent;
  border-radius:12px;
  padding:22px;
  box-shadow:0 10px 30px rgba(17,24,39,0.08);
}
.header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
  margin-bottom:18px;
}
.title{
  display:flex;
  gap:14px;
  align-items:center;
}
.logo{
  width:56px;
  height:56px;
  background:linear-gradient(135deg,#fff,#eef2ff);
  border-radius:10px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:26px;
  box-shadow:0 4px 14px rgba(17,24,39,0.06);
}
.h1{
  font-size:20px;
  font-weight:700;
  letter-spacing:0.2px;
}
.subtitle{color:var(--muted);font-size:13px}
.controls{display:flex;gap:10px;align-items:center}
.btn{
  background:var(--accent);
  color:white;
  padding:10px 14px;
  border-radius:8px;
  border:0;
  font-weight:600;
  cursor:pointer;
  box-shadow:0 6px 18px rgba(26,115,232,0.18);
}
.btn.ghost{
  background:transparent;color:var(--accent);box-shadow:none;border:1px solid rgba(26,115,232,0.12)
}
.layout{
  display:grid;
  grid-template-columns: 1fr 320px;
  gap:18px;
  align-items:start;
}
.card{
  background:var(--card);
  border-radius:12px;
  padding:18px;
  box-shadow:0 6px 20px rgba(15,23,42,0.04);
}
.left{min-height:360px}
.right{height:100%}
.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;
}
.cell{
  background:linear-gradient(180deg,#fff,#fbfdff);
  border:2px solid #e6eef9;
  border-radius:10px;
  height:96px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:36px;
  cursor:pointer;
  user-select:none;
  transition:transform .12s, box-shadow .12s, border-color .12s;
}
.cell:active{transform:scale(.98)}
.cell.selected{border-color:var(--ok);box-shadow:0 6px 18px rgba(16,185,129,0.08);background:#f6fffa}
.instruction{
  display:flex;
  gap:12px;
  align-items:center;
  margin-bottom:12px;
}
.checkrow{
  display:flex;
  gap:8px;
  align-items:center;
}
.fake-checkbox{
  width:22px;height:22px;border-radius:4px;border:2px solid #cbd5e1;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;background:white;
}
.fake-checkbox.on{background:linear-gradient(90deg,#fff,#eceffb);border-color:#9be7a3}
.small{font-size:13px;color:var(--muted)}
.message{font-weight:700;margin-top:12px}
.status{font-size:13px;color:var(--muted);margin-top:8px}
.side-list{display:flex;flex-direction:column;gap:8px}
.side-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;background:#fbfdff;border:1px solid #eef3ff}
.progress-wrap{margin-top:12px}
.progress-bar{height:12px;background:#e6eef9;border-radius:999px;overflow:hidden}
.progress-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),#60a5fa)}
.center{display:flex;align-items:center;justify-content:center}
.input{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef9;font-size:15px}
.small-muted{font-size:12px;color:var(--muted)}
.footer{margin-top:14px;display:flex;justify-content:space-between;align-items:center;gap:10px}
.hint{font-size:13px;color:var(--muted)}
.level-badge{background:#eef2ff;color:var(--accent);padding:6px 10px;border-radius:999px;font-weight:700}
.verify-btn{margin-top:14px;width:100%;padding:12px;border-radius:10px;border:0;font-weight:700;cursor:pointer;background:linear-gradient(90deg,var(--accent),#3b82f6);color:white}
.small-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.tile{background:#fff;border-radius:8px;padding:8px;border:1px solid #eef3ff;display:flex;align-items:center;justify-content:center;height:62px;font-size:28px;cursor:pointer}
.tile.matched{background:#e6ffef;border-color:#bbf7d0;box-shadow:0 6px 18px rgba(16,185,129,0.06)}
.count-box{font-weight:700;color:var(--muted)}
.timer{font-weight:700;color:var(--danger)}
.success{color:var(--ok);font-weight:800}
.fail{color:var(--danger);font-weight:800}
.footer-small{font-size:12px;color:var(--muted);text-align:center;margin-top:8px}
</style>
</head>
<body>
<div class="app">
  <div class="header">
    <div class="title">
      <div class="logo">ü§ñ</div>
      <div>
        <div class="h1">Im not a bot ü§ñ</div>
        <div class="subtitle">a captcha-ish mini game inspired by Neal.fun</div>
      </div>
    </div>
    <div class="controls">
      <div class="level-badge" id="levelBadge">Menu</div>
      <button class="btn" id="startBtn">Verify</button>
      <button class="btn ghost" id="resetBtn">Reset</button>
    </div>
  </div>

  <div class="layout">
    <div class="card left" id="mainCard">
      <div id="mainArea">
        <div class="center" style="flex-direction:column">
          <h2 id="screenTitle">Main Menu</h2>
          <div class="small-muted" id="screenSub">Press Verify to start</div>
          <div style="height:18px"></div>
          <div style="width:220px">
            <button class="verify-btn" id="menuVerify">Verify</button>
          </div>
        </div>
      </div>
    </div>

    <div class="card right">
      <div class="side-list">
        <div class="side-item">
          <div>
            <div class="small-muted">Current Level</div>
            <div id="sideLevel" style="font-weight:800">‚Äî</div>
          </div>
          <div id="sideAction" class="small-muted">Waiting</div>
        </div>

        <div class="side-item">
          <div>
            <div class="small-muted">Progress</div>
            <div class="count-box" id="sideProgress">0 / 9</div>
          </div>
          <div class="small-muted" id="sideHint">Complete captchas to advance</div>
        </div>

        <div class="side-item">
          <div>
            <div class="small-muted">Status</div>
            <div id="sideStatus" style="font-weight:800">Idle</div>
          </div>
          <div class="small-muted" id="sideExtra">Good luck!</div>
        </div>

        <div class="side-item progress-wrap">
          <div class="small-muted">Level Progress</div>
          <div class="progress-bar" style="margin-top:8px">
            <div class="progress-fill" id="levelFill"></div>
          </div>
        </div>

        <div class="side-item">
          <div class="small-muted">Tip</div>
          <div class="small-muted" id="sideTip">Levels get varied ‚Äî try different interactions.</div>
        </div>
      </div>
    </div>
  </div>

  <div class="footer-small">Built to be extended. Refresh to reset everything.</div>
</div>

<script>
const emojis = ['üê∂','üê±','üêº','ü¶ä','üêª','üê∏','ü¶Å','üê∑','üêµ','üêî','ü¶Ñ','üêô','üê¢','ü¶ã','üçé','üçå','üçá','üçì','üçç','üçë','üöó','üö≤','‚úàÔ∏è','üõ∂','üöå','üöï','üå≤','üå∏','üåµ','üî•','üíß'];
let state = {level:0,unlocked:0,clicks:0,progress:0};
const totalLevels = 9;
const mainArea = document.getElementById('mainArea');
const levelBadge = document.getElementById('levelBadge');
const sideLevel = document.getElementById('sideLevel');
const sideAction = document.getElementById('sideAction');
const sideStatus = document.getElementById('sideStatus');
const sideProgress = document.getElementById('sideProgress');
const levelFill = document.getElementById('levelFill');
const sideTip = document.getElementById('sideTip');
const startBtn = document.getElementById('startBtn');
const resetBtn = document.getElementById('resetBtn');
const menuVerify = document.getElementById('menuVerify');
const screenTitle = document.getElementById('screenTitle');
const screenSub = document.getElementById('screenSub');
let currentLevelObj = null;

function rand(arr){return arr[Math.floor(Math.random()*arr.length)]}
function shuffle(a){for(let i=a.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}

function toMenu(){
  state.level = 0;
  updateUI();
  mainArea.innerHTML = `
    <div class="center" style="flex-direction:column">
      <h2 id="screenTitle">Main Menu</h2>
      <div class="small-muted" id="screenSub">Press Verify to start</div>
      <div style="height:18px"></div>
      <div style="width:220px">
        <button class="verify-btn" id="menuVerifyBtn">Verify</button>
      </div>
    </div>
  `;
  document.getElementById('menuVerifyBtn').onclick = ()=>startLevel(1);
}

function updateUI(){
  levelBadge.textContent = state.level===0 ? 'Menu' : `Lv ${state.level}`;
  sideLevel.textContent = state.level===0 ? 'Menu' : `Level ${state.level}`;
  sideAction.textContent = state.level===0 ? 'Start' : 'In progress';
  sideStatus.textContent = state.level===0 ? 'Idle' : 'Playing';
  sideProgress.textContent = `${state.unlocked} / ${totalLevels}`;
  const pct = Math.round((state.unlocked/totalLevels)*100);
  levelFill.style.width = pct + '%';
}

function startLevel(n){
  state.level = n;
  updateUI();
  mainArea.innerHTML = '';
  currentLevelObj = levels[n];
  if(!currentLevelObj) return;
  currentLevelObj.render(mainArea,()=>levelSuccess());
}

function levelSuccess(){
  state.unlocked = Math.max(state.unlocked, state.level);
  state.progress = state.unlocked;
  updateUI();
  mainArea.innerHTML = `
    <div class="center" style="flex-direction:column">
      <div style="font-size:36px" class="success">‚úÖ Verified!</div>
      <div style="height:12px"></div>
      <div class="small-muted">Level ${state.level} complete</div>
      <div style="height:18px"></div>
      <div style="display:flex;gap:10px">
        <button class="btn" id="nextBtn">Next</button>
        <button class="btn ghost" id="menuBtn">Menu</button>
      </div>
    </div>
  `;
  document.getElementById('nextBtn').onclick = ()=>{
    const next = Math.min(totalLevels, state.level+1);
    if(state.level >= totalLevels) toMenu(); else startLevel(next);
  };
  document.getElementById('menuBtn').onclick = ()=>toMenu();
}

resetBtn.onclick = ()=>{
  state = {level:0,unlocked:0,clicks:0,progress:0};
  toMenu();
}

startBtn.onclick = ()=>{
  if(state.level===0) startLevel(1); else {
    if(currentLevelObj && currentLevelObj.verify) currentLevelObj.verify();
  }
}

menuVerify.onclick = ()=>startLevel(1);

toMenu();

const levels = {
  1:{
    render(container,done){
      screenTitle.textContent = 'Level 1 ‚Äî Pick the target';
      screenSub.textContent = 'Select all tiles that match the target emoji.';
      const target = rand(emojis);
      const correctCount = 2 + Math.floor(Math.random()*2);
      let options = [];
      for(let i=0;i<correctCount;i++) options.push(target);
      while(options.length<9) options.push(rand(emojis).replace);
      options = options.map((o,i)=> options[i]===undefined?rand(emojis):options[i]);
      while(options.length<9) options.push(rand(emojis));
      options = shuffle(options);
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div class="instruction">
          <div class="checkrow"><div class="fake-checkbox on" id="fcb"></div></div>
          <div>
            <div style="font-weight:800">Select all ${target}</div>
            <div class="small-muted">Click tiles to select. Then press Verify or use the Verify button.</div>
          </div>
        </div>
        <div class="grid" id="grid"></div>
        <div class="message" id="lvlMsg"></div>
      `;
      container.appendChild(wrapper);
      const grid = wrapper.querySelector('#grid');
      options.forEach((em,i)=>{
        const c = document.createElement('div');
        c.className='cell';
        c.textContent = em;
        c.onclick = ()=>c.classList.toggle('selected');
        grid.appendChild(c);
      });
      this.verify = ()=>{
        const cells = grid.querySelectorAll('.cell');
        let ok=true;
        cells.forEach(c=>{
          if(c.textContent===target && !c.classList.contains('selected')) ok=false;
          if(c.textContent!==target && c.classList.contains('selected')) ok=false;
        });
        const msg = wrapper.querySelector('#lvlMsg');
        if(ok){msg.textContent='Correct'; msg.style.color='var(--ok)'; setTimeout(done,700)} else {msg.textContent='Try again'; msg.style.color='var(--danger)'}
      };
    }
  },

  2:{
    render(container,done){
      screenTitle.textContent = 'Level 2 ‚Äî Odd one out';
      screenSub.textContent = 'Click the single tile that is different from the rest.';
      const base = rand(emojis);
      let other = base;
      while(other===base) other = rand(emojis);
      const tiles = Array(8).fill(base).concat([other]);
      shuffle(tiles);
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div class="instruction">
          <div style="font-weight:800">Find the odd one</div>
          <div class="small-muted">There is exactly one tile that differs.</div>
        </div>
        <div class="grid" id="grid2"></div>
        <div class="message" id="lvlMsg2"></div>
      `;
      container.appendChild(wrapper);
      const grid = wrapper.querySelector('#grid2');
      tiles.forEach(t=>{
        const c = document.createElement('div');
        c.className='cell';
        c.textContent = t;
        c.onclick = ()=>{
          const msg = wrapper.querySelector('#lvlMsg2');
          if(t!==base){msg.textContent='Correct'; msg.style.color='var(--ok)'; setTimeout(done,700)} else {msg.textContent='Nope'; msg.style.color='var(--danger)'}
        };
        grid.appendChild(c);
      });
      this.verify = ()=>{};
    }
  },

  3:{
    render(container,done){
      screenTitle.textContent = 'Level 3 ‚Äî Clicker';
      screenSub.textContent = 'Click 400 times to prove perseverance.';
      state.clicks = 0;
      const target = 400;
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div style="font-weight:800">Clicks: <span id="clickCount">0</span> / ${target}</div>
          <div class="small-muted">Tap anywhere on the button fast</div>
        </div>
        <div style="height:12px"></div>
        <div class="center">
          <button id="bigBtn" style="padding:22px 34px;border-radius:14px;font-size:18px;background:linear-gradient(90deg,#f97316,#fb923c);border:0;color:white;cursor:pointer">Click me</button>
        </div>
        <div class="message" id="clkMsg"></div>
      `;
      container.appendChild(wrapper);
      const btn = wrapper.querySelector('#bigBtn');
      const count = wrapper.querySelector('#clickCount');
      const msg = wrapper.querySelector('#clkMsg');
      btn.onclick = ()=>{
        state.clicks++;
        count.textContent = state.clicks;
        if(state.clicks>=target){msg.textContent='Nice job!'; msg.style.color='var(--ok)'; setTimeout(done,500)}
      };
      this.verify = ()=>{ if(state.clicks>=target) done(); else {msg.textContent='Keep clicking'; msg.style.color='var(--danger)'} };
    }
  },

  4:{
    render(container,done){
      screenTitle.textContent = 'Level 4 ‚Äî Slider align';
      screenSub.textContent = 'Slide until the marker falls into the green zone, then Verify.';
      const target = 20 + Math.floor(Math.random()*60);
      const slack = 6;
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div class="instruction">
          <div style="font-weight:800">Match the hidden position</div>
          <div class="small-muted">Stop the slider as close to the target area as possible.</div>
        </div>
        <div style="padding:8px 0">
          <input type="range" id="sld" min="0" max="100" value="50" style="width:100%">
          <div style="display:flex;justify-content:space-between;font-size:12px;color:var(--muted);margin-top:6px">
            <div>0</div><div>100</div>
          </div>
        </div>
        <div style="height:8px"></div>
        <div class="small-muted">Green band (visual) approximates the target zone.</div>
        <div style="height:10px"></div>
        <div style="height:18px;position:relative">
          <div style="position:absolute;left:${target}%;transform:translateX(-50%);top:0;background:#ecfdf5;border-radius:6px;padding:4px 6px;color:#065f46;font-weight:700">‚úì</div>
        </div>
        <div class="message" id="sldMsg"></div>
      `;
      container.appendChild(wrapper);
      const sld = wrapper.querySelector('#sld');
      const msg = wrapper.querySelector('#sldMsg');
      this.verify = ()=>{
        const v = Number(sld.value);
        if(Math.abs(v-target) <= slack){msg.textContent='Good alignment'; msg.style.color='var(--ok)'; setTimeout(done,700)} else {msg.textContent='Not aligned'; msg.style.color='var(--danger)'}
      };
    }
  },

  5:{
    render(container,done){
      screenTitle.textContent = 'Level 5 ‚Äî Type the emoji name';
      screenSub.textContent = 'Type the name of the shown emoji (simple English, lowercase acceptable).';
      const pool = ['dog','cat','fox','bear','panda','lion','owl','pig','monkey','chicken','unicorn','octopus','turtle','butterfly','apple','banana','grape','strawberry','pineapple','peach','car','bike','plane','bus','tree','flower','cactus','fire','water'];
      const word = rand(pool);
      const map = {
        dog:'üê∂',cat:'üê±',fox:'ü¶ä',bear:'üêª',panda:'üêº',lion:'ü¶Å',owl:'ü¶â',pig:'üê∑',monkey:'üêµ',chicken:'üêî',unicorn:'ü¶Ñ',octopus:'üêô',turtle:'üê¢',butterfly:'ü¶ã',apple:'üçé',banana:'üçå',grape:'üçá',strawberry:'üçì',pineapple:'üçç',peach:'üçë',car:'üöó',bike:'üö≤',plane:'‚úàÔ∏è',bus:'üöå',tree:'üå≤',flower:'üå∏',cactus:'üåµ',fire:'üî•',water:'üíß'
      };
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div style="font-size:40px;text-align:center">${map[word]||'‚ùì'}</div>
        <div style="height:12px"></div>
        <div class="small-muted" style="text-align:center">Enter the English word for the emoji above.</div>
        <div style="height:12px"></div>
        <input class="input" id="typed" placeholder="type the word here">
        <div class="message" id="wordMsg"></div>
      `;
      container.appendChild(wrapper);
      const typed = wrapper.querySelector('#typed');
      const msg = wrapper.querySelector('#wordMsg');
      this.verify = ()=>{
        const v = typed.value.trim().toLowerCase();
        if(v===word){msg.textContent='Correct';msg.style.color='var(--ok)';setTimeout(done,600)} else {msg.textContent='Incorrect';msg.style.color='var(--danger)'}
      };
    }
  },

  6:{
    render(container,done){
      screenTitle.textContent = 'Level 6 ‚Äî Memory match';
      screenSub.textContent = 'Find all matching pairs (limited board).';
      const pairs = 3;
      const pool = shuffle(emojis.slice()).slice(0,pairs);
      let tiles = pool.concat(pool);
      tiles = shuffle(tiles);
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div class="small-muted">Flip two tiles; find all ${pairs} pairs.</div>
        <div style="height:12px"></div>
        <div class="small-grid" id="mg"></div>
        <div class="message" id="memMsg"></div>
      `;
      container.appendChild(wrapper);
      const grid = wrapper.querySelector('#mg');
      let first=null;
      let lock=false;
      let matches=0;
      tiles.forEach((t,i)=>{
        const tile = document.createElement('div');
        tile.className='tile';
        tile.textContent = '';
        tile.dataset.val = t;
        tile.onclick = ()=>{
          if(lock || tile.classList.contains('matched')) return;
          tile.textContent = t;
          if(!first){first=tile;return}
          if(first===tile) return;
          lock=true;
          setTimeout(()=>{
            if(first.dataset.val===tile.dataset.val){
              first.classList.add('matched');
              tile.classList.add('matched');
              matches++;
              if(matches===pairs){wrapper.querySelector('#memMsg').textContent='All matched';wrapper.querySelector('#memMsg').style.color='var(--ok)';setTimeout(done,700)}
            } else {
              first.textContent='';tile.textContent='';
            }
            first=null;lock=false;
          },500);
        };
        grid.appendChild(tile);
      });
      this.verify = ()=>{};
    }
  },

  7:{
    render(container,done){
      screenTitle.textContent = 'Level 7 ‚Äî Quick math';
      screenSub.textContent = 'Solve the shown arithmetic.';
      const a = 2 + Math.floor(Math.random()*8);
      const b = 1 + Math.floor(Math.random()*9);
      const ops = ['+','-','√ó'];
      const op = rand(ops);
      let result = 0;
      if(op==='+') result = a+b;
      if(op==='-') result = a-b;
      if(op==='√ó') result = a*b;
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div style="font-weight:800;font-size:22px">${a} ${op} ${b} = ?</div>
        <div style="height:10px"></div>
        <input class="input" id="mathIn" placeholder="enter result">
        <div class="message" id="mathMsg"></div>
      `;
      container.appendChild(wrapper);
      const mi = wrapper.querySelector('#mathIn');
      const msg = wrapper.querySelector('#mathMsg');
      this.verify = ()=>{
        const v = Number(mi.value.trim());
        if(v===result){msg.textContent='Correct';msg.style.color='var(--ok)';setTimeout(done,600)} else {msg.textContent='Wrong';msg.style.color='var(--danger)'}
      };
    }
  },

  8:{
    render(container,done){
      screenTitle.textContent = 'Level 8 ‚Äî Order the clicks';
      screenSub.textContent = 'Click the tiles in numeric order 1 ‚Üí 5.';
      const count = 5;
      const nums = [];
      for(let i=1;i<=count;i++) nums.push(i);
      shuffle(nums);
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div class="small-muted">Click numbers from 1 to ${count} in order.</div>
        <div style="height:12px"></div>
        <div class="small-grid" id="numGrid"></div>
        <div class="message" id="ordMsg"></div>
      `;
      container.appendChild(wrapper);
      const grid = wrapper.querySelector('#numGrid');
      let next = 1;
      nums.forEach(n=>{
        const t = document.createElement('div');
        t.className='tile';
        t.textContent = n;
        t.onclick = ()=>{
          if(n===next){
            t.classList.add('matched');
            next++;
            if(next>count){wrapper.querySelector('#ordMsg').textContent='Done';wrapper.querySelector('#ordMsg').style.color='var(--ok)';setTimeout(done,600)}
          } else {
            wrapper.querySelector('#ordMsg').textContent='Wrong order';wrapper.querySelector('#ordMsg').style.color='var(--danger)';
          }
        };
        grid.appendChild(t);
      });
      this.verify = ()=>{};
    }
  },

  9:{
    render(container,done){
      screenTitle.textContent = 'Level 9 ‚Äî Repeat the pattern';
      screenSub.textContent = 'Watch the short sequence, then repeat it. Time matters.';
      const seqLen = 4;
      const pool = ['üî¥','üîµ','üü¢','üü°','üü£'];
      const seq = [];
      for(let i=0;i<seqLen;i++) seq.push(rand(pool));
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div class="small-muted">Watch, then repeat by clicking the color tiles in the same order.</div>
        <div style="height:12px"></div>
        <div class="small-grid" id="patternGrid"></div>
        <div style="height:12px"></div>
        <div class="small-muted" id="replayMsg"></div>
      `;
      container.appendChild(wrapper);
      const grid = wrapper.querySelector('#patternGrid');
      pool.forEach(p=>{
        const t = document.createElement('div');
        t.className='tile';
        t.textContent = p;
        grid.appendChild(t);
      });
      const replayMsg = wrapper.querySelector('#replayMsg');
      let playback = true;
      let userIdx = 0;
      let displayed = [];
      function playSequence(i=0){
        if(i>=seq.length){playback=false;replayMsg.textContent='Your turn';return}
        const val = seq[i];
        const tile = Array.from(grid.children).find(n=>n.textContent===val);
        if(!tile) return;
        const old = tile.textContent;
        tile.style.transform='scale(1.08)';
        setTimeout(()=>tile.style.transform='',350);
        setTimeout(()=>playSequence(i+1),500);
      }
      setTimeout(()=>playSequence(),300);
      Array.from(grid.children).forEach(t=>{
        t.onclick = ()=>{
          if(playback) return;
          const want = seq[userIdx];
          if(t.textContent===want){
            userIdx++;
            if(userIdx===seq.length){replayMsg.textContent='Pattern matched';replayMsg.style.color='var(--ok)';setTimeout(done,600)}
          } else {
            replayMsg.textContent='Wrong pattern';replayMsg.style.color='var(--danger)';playback=true;userIdx=0;setTimeout(()=>{playSequence();replayMsg.textContent='';},800);
          }
        };
      });
      this.verify = ()=>{};
    }
  }
};
</script>
</body>
</html>
